{"ast":null,"code":"var _jsxFileName = \"/home/bernardoabreu/Desktop/wp5-dashboard/dashboard/src/App.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nimport React, { useEffect, useState, lazy, Suspense } from \"react\";\nimport './App.css';\nimport { RecoilRoot, atom, useRecoilState } from \"recoil\";\nimport { ThemeProvider } from '@emotion/react'; // function loadComponent(scope, module) {\n//   return async () => {\n//     // Initializes the shared scope. Fills it with known provided modules from this build and all remotes\n//     await __webpack_init_sharing__('default');\n//     const container = window[scope]; // or get the container somewhere else\n//     // Initialize the container, it may provide shared modules\n//     await container.init(__webpack_share_scopes__.default);\n//     const factory = await window[scope].get(module);\n//     const Module = factory();\n//     return Module;\n//   };\n// }\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst useDynamicScript = args => {\n  _s();\n\n  const [ready, setReady] = useState(false);\n  const [failed, setFailed] = useState(false);\n  useEffect(() => {\n    if (!args.url) return;\n    const element = document.createElement(\"script\");\n    element.src = args.url;\n    element.type = \"text/javascript\";\n    element.async = true;\n    setReady(false);\n    setFailed(false);\n\n    element.onload = () => {\n      console.log(`Dynamic Script Loaded: ${args.url}`);\n      setReady(true);\n    };\n\n    element.onerror = () => {\n      console.error(`Dynamic Script Error: ${args.url}`);\n      setReady(false);\n      setFailed(true);\n    };\n\n    document.head.appendChild(element);\n    return () => {\n      console.log(`Dynamic Script Removed: ${args.url}`);\n      document.head.removeChild(element);\n    };\n  }, [args.url]);\n  return {\n    ready,\n    failed\n  };\n};\n\n_s(useDynamicScript, \"cgCmnFs4LO4f1+dqEfelQq09bhU=\");\n\nconst RemoteReactComponent = ({\n  url,\n  module: targetModule,\n  scope,\n  ...props\n}) => {\n  _s2();\n\n  console.log('props :>> ', props);\n  const {\n    state\n  } = props;\n  console.log('state :>> ', state);\n  const {\n    ready,\n    failed\n  } = useDynamicScript({\n    url\n  }); // if (ready) {\n  //   const o = global[\"webpack_require\"] ? global[\"webpack_require\"].o : {};\n  //   console.log('scope :>> ', scope);\n  //   window[\"graph1\"].override(\n  //     Object.assign(\n  //       {\n  //         react: () => Promise.resolve().then(() => () => require(\"react\")),\n  //       },\n  //       o\n  //     )\n  //   );\n  // }\n\n  if (!ready) return /*#__PURE__*/_jsxDEV(\"h2\", {\n    children: [\"Loading dynamic script: \", url]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 22\n  }, this);\n  if (failed) return /*#__PURE__*/_jsxDEV(\"h2\", {\n    children: [\"Failed to load dynamic script: \", url]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 22\n  }, this);\n  const Component = /*#__PURE__*/React.lazy(() => new Promise(resolve => {\n    const moduleResolve = resolve;\n\n    const react = require(\"react\");\n\n    const legacyShareScope = {\n      react: {\n        [react.version]: {\n          get: () => new Promise(resolve => resolve(() => react)),\n          loaded: true,\n          from: \"webpack4\"\n        }\n      }\n    };\n    new Promise(resolve => {\n      resolve(window[scope].init(legacyShareScope));\n    }).then(() => {\n      window[scope].get(targetModule).then(factory => {\n        moduleResolve(factory());\n      });\n    });\n  }));\n  return /*#__PURE__*/_jsxDEV(Suspense, {\n    fallback: \"Loading System\",\n    children: /*#__PURE__*/_jsxDEV(Component, { ...props\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 115,\n    columnNumber: 5\n  }, this);\n};\n\n_s2(RemoteReactComponent, \"DD7iWqYvsRB3t/fItKErVD9mgCY=\", false, function () {\n  return [useDynamicScript];\n});\n\n_c = RemoteReactComponent;\nconst theme = {\n  colors: {\n    primary: \"hotpink\"\n  }\n};\n\nconst DashboardWidget = ({\n  name,\n  ...props\n}) => {\n  return /*#__PURE__*/_jsxDEV(RemoteReactComponent, {\n    url: `http://localhost:3001/${name}/remoteEntry.js`,\n    module: name,\n    scope: name,\n    ...props\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 128,\n    columnNumber: 11\n  }, this);\n};\n\n_c2 = DashboardWidget;\nconst graphState = atom({\n  key: \"graphState\",\n  default: 14\n});\nconsole.log('graphState :>> ', graphState);\n\nfunction Dashboard() {\n  _s3();\n\n  const [graph] = useRecoilState(graphState);\n  console.log('graph Dash:>> ', graph);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: 10\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        fontSize: \"xx-large\"\n      },\n      children: [\"Data: \", JSON.stringify(graph)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DashboardWidget, {\n      name: \"graph1\",\n      state: graph\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 149,\n    columnNumber: 5\n  }, this);\n}\n\n_s3(Dashboard, \"+ewhoWlh1fjmsiVoy+Pxxhn7QV4=\", false, function () {\n  return [useRecoilState];\n});\n\n_c3 = Dashboard;\n\nfunction App() {\n  return /*#__PURE__*/_jsxDEV(ThemeProvider, {\n    theme: theme,\n    children: /*#__PURE__*/_jsxDEV(RecoilRoot, {\n      children: /*#__PURE__*/_jsxDEV(Dashboard, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 163,\n    columnNumber: 5\n  }, this);\n}\n\n_c4 = App;\nexport default App;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"RemoteReactComponent\");\n$RefreshReg$(_c2, \"DashboardWidget\");\n$RefreshReg$(_c3, \"Dashboard\");\n$RefreshReg$(_c4, \"App\");","map":{"version":3,"sources":["/home/bernardoabreu/Desktop/wp5-dashboard/dashboard/src/App.js"],"names":["React","useEffect","useState","lazy","Suspense","RecoilRoot","atom","useRecoilState","ThemeProvider","useDynamicScript","args","ready","setReady","failed","setFailed","url","element","document","createElement","src","type","async","onload","console","log","onerror","error","head","appendChild","removeChild","RemoteReactComponent","module","targetModule","scope","props","state","Component","Promise","resolve","moduleResolve","react","require","legacyShareScope","version","get","loaded","from","window","init","then","factory","theme","colors","primary","DashboardWidget","name","graphState","key","default","Dashboard","graph","padding","fontSize","JSON","stringify","App"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, lazy, Suspense } from \"react\";\nimport './App.css';\nimport { RecoilRoot, atom, useRecoilState } from \"recoil\";\nimport { ThemeProvider } from '@emotion/react';\n\n// function loadComponent(scope, module) {\n//   return async () => {\n//     // Initializes the shared scope. Fills it with known provided modules from this build and all remotes\n//     await __webpack_init_sharing__('default');\n//     const container = window[scope]; // or get the container somewhere else\n//     // Initialize the container, it may provide shared modules\n//     await container.init(__webpack_share_scopes__.default);\n//     const factory = await window[scope].get(module);\n//     const Module = factory();\n//     return Module;\n//   };\n// }\n\nconst useDynamicScript = (args) => {\n  const [ready, setReady] = useState(false);\n  const [failed, setFailed] = useState(false);\n\n  useEffect(() => {\n    if(!args.url) return;\n\n    const element = document.createElement(\"script\");\n\n    element.src = args.url;\n    element.type = \"text/javascript\";\n    element.async = true;\n\n    setReady(false);\n    setFailed(false);\n\n    element.onload = () => {\n      console.log(`Dynamic Script Loaded: ${args.url}`);\n      setReady(true);\n    };\n\n    element.onerror = () => {\n      console.error(`Dynamic Script Error: ${args.url}`);\n      setReady(false);\n      setFailed(true);\n    };\n\n    document.head.appendChild(element);\n\n    return () => {\n      console.log(`Dynamic Script Removed: ${args.url}`);\n      document.head.removeChild(element);\n    };\n  }, [args.url])\n\n  return {\n    ready,\n    failed\n  };\n};\n\nconst RemoteReactComponent = ({ url, module: targetModule, scope, ...props }) => {\n\n  console.log('props :>> ', props);\n\n  const { state } = props;\n\n  console.log('state :>> ', state);\n\n  const { ready, failed } = useDynamicScript({\n    url,\n  });\n\n  // if (ready) {\n  //   const o = global[\"webpack_require\"] ? global[\"webpack_require\"].o : {};\n  //   console.log('scope :>> ', scope);\n\n  //   window[\"graph1\"].override(\n  //     Object.assign(\n  //       {\n  //         react: () => Promise.resolve().then(() => () => require(\"react\")),\n  //       },\n  //       o\n  //     )\n  //   );\n  // }\n\n  if (!ready) return <h2>Loading dynamic script: {url}</h2>;\n  \n  if (failed) return <h2>Failed to load dynamic script: {url}</h2>;\n\n  const Component = React.lazy(\n    () =>\n      new Promise((resolve) => {\n        const moduleResolve = resolve;\n        const react = require(\"react\");\n        const legacyShareScope = {\n          react: {\n            [react.version]: {\n              get: () => new Promise((resolve) => resolve(() => react)),\n              loaded: true,\n              from: \"webpack4\",\n            },\n          },\n        };\n        new Promise((resolve) => {\n          resolve(window[scope].init(legacyShareScope));\n        }).then(() => {\n          window[scope].get(targetModule).then((factory) => {\n            moduleResolve(factory());\n          });\n        });\n      })\n  );\n\n  return (\n    <Suspense fallback=\"Loading System\">\n      <Component {...props} />\n    </Suspense>\n  )\n}\n\nconst theme = {\n  colors: {\n    primary: \"hotpink\",\n  },\n};\n\nconst DashboardWidget = ({ name, ...props }) => {\n  return (<RemoteReactComponent \n    url={`http://localhost:3001/${name}/remoteEntry.js`}\n    module={name}\n    scope={name}\n    {...props}\n  />);\n}\n\nconst graphState = atom({\n  key: \"graphState\",\n  default: 14,\n});\n\nconsole.log('graphState :>> ', graphState);\n\nfunction Dashboard() {\n  const [graph, ] = useRecoilState(graphState);\n\n  console.log('graph Dash:>> ', graph);\n\n  return (\n    <div style={{\n      padding: 10,\n    }}>\n      <div style={{ fontSize: \"xx-large\" }}>Data: {JSON.stringify(graph)}</div>\n      <DashboardWidget \n        name=\"graph1\" \n        state={graph} \n      />\n    </div>\n  );\n}\n\nfunction App() {\n  return (\n    <ThemeProvider theme={theme}>\n      <RecoilRoot>\n        <Dashboard />\n      </RecoilRoot>\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}